<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Blue Brain BioExplorer: User guide</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../BBBE_icon_64.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Blue Brain BioExplorer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/d23/md_bioexplorer_pythonsdk_doc_source_USERGUIDE.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">User guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md57"></a>
Protein</h1>
<p>Proteins are loaded from PDB files. Atoms, non-polymer chemicals and bonds can be loaded and displayed in various color schemes: chain id, atom, residue, etc.... Proteins also contain the amino acid sequences of the individual chains; these sequences can be used to query targeted sites (such as glycosylation sites), or functional regions of the protein.</p>
<div class="fragment"><div class="line">virus_protein_s = Protein(</div>
<div class="line">    name=&#39;Spike&#39;,</div>
<div class="line">    source=&#39;6vyb.pdb&#39;,</div>
<div class="line">    number_of_instances=nb_protein_s,</div>
<div class="line">    assembly_params=[11.5])</div>
</div><!-- fragment --><p> <img src="../../6vyb.png" alt="" class="inline"/></p>
<p>The Jupyter Python notebooks provide a simple and convenient way to create molecular systems. The BioExplorer exposes a number of primitives such as proteins or sugars, as well as complex systems like viruses or membranes. In the paragraph, we describe how to load and visualize a single protein, its glycosylation sites, and the glycans attached to them.</p>
<div class="fragment"><div class="line">from bioexplorer import BioExplorer, Protein</div>
<div class="line">be = BioExplorer(&#39;localhost:5000&#39;)</div>
<div class="line">ace2_receptor = Protein(sources=[&#39;6m1d.pdb&#39;])</div>
<div class="line">status = be.add_protein(</div>
<div class="line">    name=&#39;ACE2 receptor&#39;, protein=ace2_receptor)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md58"></a>
Glycan</h1>
<p>Glycans are small elements (branches of monosaccharides) that are attached to an existing protein of the assembly. Individual glycan trees are loaded from PDB files and attached to the glycosylation sites of the specified protein. By default, glycans are attached to all available glycosylation sites, but a set of specific sites can be specified.</p>
<div class="fragment"><div class="line">be.add_multiple_glycans(</div>
<div class="line">    assembly_name=name, glycan_type=be.NAME_GLYCAN_HIGH_MANNOSE,</div>
<div class="line">    protein_name=be.NAME_PROTEIN_S_CLOSED,</div>
<div class="line">    paths=[&#39;high_mannose_glycan.pdb&#39;])</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md59"></a>
RNA sequence</h1>
<p>An RNA sequence can be loaded from a text sequence of nucleotides. Various shapes can be selected to represent the RNA sequence: Trefoil knot, torus, star, etc….. This allows the sequence to be efficiently packed into a given volume. A different color is assigned per type of nucleotides.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Membrane</h1>
<p>A membrane is an assembly of phospholipids. Phospholipids structures are created following the process described in the VMD (<a href="https://www.ks.uiuc.edu/Research/vmd/">https://www.ks.uiuc.edu/Research/vmd/</a>) Membrane Proteins Tutorial (<a href="http://www.ks.uiuc.edu/Training/Tutorials/">http://www.ks.uiuc.edu/Training/Tutorials/</a>). The assembly itself is generated by the BioExplorer, for a given shape, and a number of instances of phospholipids.</p>
<div class="fragment"><div class="line">virus_membrane = Membrane(lipid_sources=[&#39;popc.pdb&#39;])</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md61"></a>
Surfactants</h1>
<p>The BioExplorer exposes an API to help create 3D models of surfactants, according to given proteins for the branches and for the head.</p>
<div class="fragment"><div class="line">surfactant_a = Surfactant(</div>
<div class="line">        name=&#39;Surfactant-A&#39;,</div>
<div class="line">surfactant_protein=be.SURFACTANT_PROTEIN_A,</div>
<div class="line">        head_source=surfactant_head_source,</div>
<div class="line">        branch_source=surfactant_branch_source)</div>
<div class="line"> </div>
<div class="line">be.add_surfactant(</div>
<div class="line">        surfactant=surfactant_a,</div>
<div class="line">        representation=protein_representation,</div>
<div class="line">        atom_radius_multiplier=protein_radius_multiplier,</div>
<div class="line">        position=Vector3(), random_seed=2)</div>
</div><!-- fragment --><p> <img src="../../surfactant-d.png" alt="" class="inline"/></p>
<p><img src="../../surfactant-a.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md62"></a>
Virus</h1>
<p>A viral particle (= “virus”) is an assembly consisting of a membrane, an RNA sequence, and a given number of S, M and E proteins. The virus has a predefined spherical shape defined by its radius. The default parameters for the virus are a radius of 45 nanometers, 62 S proteins, 42 E proteins, and 50 M proteins. Dimensions and concentrations were retrieved from the literature (see list of dimensions and concentrations in appendix B2 and B3)</p>
<div class="fragment"><div class="line">virus_protein_s = Protein(</div>
<div class="line">    name=&#39;Spike&#39;,</div>
<div class="line">    source=&#39;6vyb.pdb&#39;,</div>
<div class="line">    number_of_instances=62,</div>
<div class="line">    transmembrane_params=Vector2(10.5, 10.5)</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">virus_protein_e = Protein(</div>
<div class="line">    name=&#39;E Protein&#39;,</div>
<div class="line">    source=&#39;QHD43418a.pdb&#39;,</div>
<div class="line">    number_of_instances=42,</div>
<div class="line">    transmembrane_params=Vector2(0.5, 2.0)</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">virus_protein_m = Protein(</div>
<div class="line">    name=&#39;M Protein&#39;,</div>
<div class="line">    source=&#39;QHD43419a.pdb&#39;,</div>
<div class="line">    number_of_instances=50,</div>
<div class="line">    transmembrane_params=Vector2(0.5, 2.0)</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">virus_membrane = Membrane(lipid_sources=[&#39;popc.pdb&#39;])</div>
<div class="line"> </div>
<div class="line">rna_sequence = RNASequence(</div>
<div class="line">    source=&#39;sars-cov-2.rna&#39;,</div>
<div class="line">    shape=be.RNA_SHAPE_TREFOIL_KNOT,</div>
<div class="line">    shape_params=[11.0, 0.5],</div>
<div class="line">    values_range=Vector2(0, 30.5 * math.pi),</div>
<div class="line">    curve_params=Vector3(1.51, 1.12, 1.93)</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">virus_cell = Cell(</div>
<div class="line">    name=&#39;Cell&#39;,</div>
<div class="line">    shape=be.ASSEMBLY_SHAPE_EMPTY_SPHERE,</div>
<div class="line">    shape_params=shape_params, membrane=virus_membrane,</div>
<div class="line">    proteins=[virus_protein_s, virus_protein_e, virus_protein_m])</div>
<div class="line"> </div>
<div class="line">bio_explorer.add_cell(cell=virus_cell)</div>
</div><!-- fragment --><p>In order to ease the process of creating 3D detailed representations of viruses, an advanced API function with the default SARS-COV-2 coronavirus parameters is provided by the BioExplorer:</p>
<div class="fragment"><div class="line">be.add_sars_cov_2(</div>
<div class="line">    name=&#39;sars-cov-2&#39;, resource_folder=resource_folder,</div>
<div class="line">    representation=be.REPRESENTATION_ATOMS,</div>
<div class="line">    add_glycans=True)</div>
</div><!-- fragment --><p> <img src="../../coronavirus.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md63"></a>
Host cell</h1>
<p>A host cell is an assembly composed of a membrane of a given size and shape (cylindric, sinusoidal, ect), and a given number of ACE2 receptors.</p>
<div class="fragment"><div class="line">ace2_receptor = Protein(</div>
<div class="line">    name=&#39;ACE2&#39;,</div>
<div class="line">    sources=&#39;6m1d.pdb&#39;, number_of_instances=20,</div>
<div class="line">    transmembrane_params=Vector2(0.5, 2.0)</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">membrane = Membrane(lipid_sources=[&#39;popc.pdb&#39;])</div>
<div class="line"> </div>
<div class="line">host_cell = Cell(</div>
<div class="line">    name=&#39;Host cell&#39;,</div>
<div class="line">    shape=be.ASSEMBLY_SHAPE_SINUSOIDAL,</div>
<div class="line">    shape_params=Vector3(20.0, 20.0, 20.0),</div>
<div class="line">    membrane=membrane,</div>
<div class="line">    proteins=[ace2_receptor]</div>
<div class="line">)</div>
</div><!-- fragment --><p> <img src="../../cell.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md64"></a>
Glycans Models</h1>
<p>Glycan trees models are retrieved from Glycam Builder (<a href="http://glycam.org/Pre-builtLibraries.jsp">http://glycam.org/Pre-builtLibraries.jsp</a>). Only one exemplar of each type of glycan (HM, C, Hy and O-type) is represented in the current reconstruction and listed in appendix C1. Glycosylation sites can be visualized by applying a specific color scheme (COLOR_SCHEME_GLYCOSYLATION_SITE) to the protein.</p>
<div class="fragment"><div class="line">status = be.set_protein_color_scheme(</div>
<div class="line">    assembly_name=name, name=name,</div>
<div class="line">    color_scheme=be.COLOR_SCHEME_GLYCOSYLATION_SITE,</div>
<div class="line">    palette_name=&#39;Set1&#39;, palette_size=2)</div>
</div><!-- fragment --><p> <img src="../../6vyb_glycosylation_sites.png" alt="" class="inline"/></p>
<p>Glycosylation sites are automatically identified according to the amino acids sequence. When a N is found in the sequence, a glycosylation site exists if the next amino acid in the sequence is a not a P, and the following one is a T or a S.</p>
<p>Using that simple algorithm, glycans trees can be added to the Protein object. Glycans make use of a generic python object called Sugars. By providing the name of the assembly and the target protein, the BioExplorer automatically adds the Glycans to the identified glycosylation sites.</p>
<div class="fragment"><div class="line">glycan_name = name + &#39;_Complex&#39;</div>
<div class="line">glycans = Sugars(</div>
<div class="line">    assembly_name=name, protein_name=name, </div>
<div class="line">    name=glycan_name, source=&#39;10.pdb&#39;)</div>
<div class="line">Status = be.add_glycans(glycans)</div>
</div><!-- fragment --><p> <img src="../../6vyb_glycans.png" alt="" class="inline"/></p>
<p>Multiple types of glycan trees can be also added to the Protein object, for specific glycosylation sites.</p>
<div class="fragment"><div class="line">high_mannose_glycans = Sugars(</div>
<div class="line">    site_indices=[80, 141, 253], ...)</div>
<div class="line">status = be.add_glycans(high_mannose_glycans)</div>
<div class="line">complex_glycans = Sugars(</div>
<div class="line">    site_indices=[36, 93, 168], ...)</div>
<div class="line">status = be.add_glycans(complex_glycans)</div>
</div><!-- fragment --><p> <img src="../../6vyb_all_glycans.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md65"></a>
Visualization</h1>
<p>A specific site or an amino-acid sequence can be visualized on the protein by providing a range of indices, and applying a specific color scheme (COLOR_SCHEME_AMINO_ACID_SEQUENCE) to the protein.</p>
<div class="fragment"><div class="line">status = be.set_protein_amino_acid_sequence_as_range(</div>
<div class="line">    assembly_name=name, name=name, amino_acid_range=[500,750])</div>
<div class="line">status = be.set_protein_color_scheme(</div>
<div class="line">    assembly_name=name, name=name,</div>
<div class="line">    color_scheme=be.COLOR_SCHEME_AMINO_ACID_SEQUENCE,</div>
<div class="line">    palette_name=&#39;Set1&#39;, palette_size=2)</div>
</div><!-- fragment --><p> <img src="../../6vyb_aa_by_range.png" alt="" class="inline"/></p>
<p>A specific site or an amino-acid sequence can also be specified by substring of the sequence, and applying a specific color scheme (COLOR_SCHEME_AMINO_ACID_SEQUENCE) to the protein.</p>
<div class="fragment"><div class="line">aa_sequence = &#39;ANNCTFEYVSQPFLMDLEGKQGNFKNLREFVFKNIDGYFKIYSKHTPINLVRD&#39;</div>
<div class="line"> </div>
<div class="line">status = be.set_protein_amino_acid_sequence_as_string(</div>
<div class="line">    assembly_name=name, name=name, amino_acid_sequence=aa_sequence)</div>
<div class="line"> </div>
<div class="line">status = be.set_protein_color_scheme(</div>
<div class="line">    assembly_name=name, name=name,</div>
<div class="line">    color_scheme=be.COLOR_SCHEME_AMINO_ACID_SEQUENCE,</div>
<div class="line">    palette_name=&#39;Set1&#39;, palette_size=2)</div>
</div><!-- fragment --><p> <img src="../../6vyb_aa_by_string.png" alt="" class="inline"/></p>
<p>Functional regions of a protein can be visualized by providing the indices of the regions in the amino acids sequence, and applying a specific color scheme (COLOR_SCHEME_REGIONS) to the protein.</p>
<div class="fragment"><div class="line">region_indices_and_colors = [</div>
<div class="line">    [1, grey], [16, blue], [306, grey], [330, green],</div>
<div class="line">    [438, dark_green], [507, green], [522, grey], [816, red],</div>
<div class="line">    [835, grey], [908, yellow], [986, grey], [1076, cyan],</div>
<div class="line">    [1274, grey], [2000, grey ]]</div>
<div class="line">status = be.set_protein_color_scheme(</div>
<div class="line">    assembly_name=name, name=name,</div>
<div class="line">    color_scheme=be.COLOR_SCHEME_REGION, palette=palette)</div>
</div><!-- fragment --><p><img src="../../6vyb_regions.png" alt="" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
